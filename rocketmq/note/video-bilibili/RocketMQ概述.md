# RocketMQ 概述

[本文总结自视频](https://www.bilibili.com/video/BV1cf4y157sz)

## MQ 概述

### MQ 简介

MQ，即 Message Queue，是一种提供消息队列服务的中间件，也称为消息中间件，是一套提供了消息生产、存储、消费全过程 API 的软件系统。消息可以简单认为是数据，一般而言，消息体不会太大。

### MQ 用途

主要分为 异步处理、应用解耦、流量削峰、日志处理 等应用场景。

#### 异步处理

**场景举例**：用户注册后，需要发送注册邮件和注册短信，传统的做法有两种，即串行和并行方式。

**串行方式**：将注册信息写入数据库成功后，发送注册邮件，再发送注册短信，当这三个任务全部完成后，返回结果给客户端。

![异步处理-串行方式](https://images.cnblogs.com/cnblogs_com/parzulpan/1907498/o_210102072809%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86%E4%B8%B2%E8%A1%8C%E6%96%B9%E5%BC%8F.png)

**并行方式**：将注册信息写入数据库成功后，发送注册邮件的同时，发送注册短信，当这三个任务完成后，返回结果给客户端。与串行的差别是，并行的方式可以提高处理的时间。

![异步处理-并行方式](https://images.cnblogs.com/cnblogs_com/parzulpan/1907498/o_210102072829异步处理并行方式.png)

**引入消息队列后**，将不是必须的业务逻辑，可以异步处理，改造后的架构为：

![异步处理-引入消息队列](https://images.cnblogs.com/cnblogs_com/parzulpan/1907498/o_210102072837%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86%E5%BC%95%E5%85%A5%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.png)



#### 应用解耦

**场景举例**：用户下单后，订单系统需要通知库存系统。传统的做法是，订单系统调用库存系统的接口，如下图：

![应用解耦-传统做法](https://images.cnblogs.com/cnblogs_com/parzulpan/1907498/o_210102072847%E5%BA%94%E7%94%A8%E8%A7%A3%E8%80%A6%E4%BC%A0%E7%BB%9F%E5%81%9A%E6%B3%95.png)

**传统做法的缺点**：假如库存系统无法访问，或者系统崩了，则订单减库存将失败，从而导致订单失败，订单系统与库存系统耦合严重。

**引入消息队列后**，对于订单系统，用户下单后，订单系统完成持久化处理，将消息写入消息队列，返回用户订单下单成功；对于库存系统，订阅下单的消息，采用**拉/推**的方式，获取下单信息，库存系统根据下单信息，进行库存操作。

![应用解耦-引入消息队列](https://images.cnblogs.com/cnblogs_com/parzulpan/1907498/o_210102072856%E5%BA%94%E7%94%A8%E8%A7%A3%E8%80%A6%E5%BC%95%E5%85%A5%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.png)



#### 流量削峰



#### 日志处理



### 常见 MQ 产品



### 常见 MQ 协议





## RocketMQ 概述



## 总结

